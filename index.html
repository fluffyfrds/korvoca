<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KorVoca - ÌïúÍµ≠Ïñ¥ Îã®Ïñ¥ ÌïôÏäµ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Malgun Gothic', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .mode-selector {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }

        .mode-selector h3 {
            margin-bottom: 15px;
            color: #5a67d8;
        }

        .mode-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .mode-btn {
            padding: 10px 20px;
            border: 2px solid #5a67d8;
            background: white;
            color: #5a67d8;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
        }

        .mode-btn.active {
            background: #5a67d8;
            color: white;
        }

        .mode-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(90,103,216,0.3);
        }

        .day-selector {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            text-align: center;
        }

        .day-selector h3 {
            margin-bottom: 25px;
            color: #5a67d8;
            font-size: 1.3em;
        }

        .day-control {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 30px;
            margin-bottom: 20px;
        }

        .arrow-btn {
            background: linear-gradient(135deg, #5a67d8, #667eea);
            color: white;
            border: none;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            font-size: 1.5em;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(90,103,216,0.3);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .arrow-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(90,103,216,0.4);
        }

        .arrow-btn:active {
            transform: translateY(-1px);
        }

        .arrow-btn:disabled {
            background: #cbd5e0;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .day-display {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 20px;
            min-width: 200px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
        }

        .day-title {
            font-size: 2.2em;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .day-info {
            font-size: 0.9em;
        }

        .day-progress, .day-rounds {
            margin-bottom: 8px;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255,255,255,0.3);
            border-radius: 4px;
            overflow: hidden;
            margin: 8px 0;
        }

        .progress-fill {
            height: 100%;
            background: rgba(255,255,255,0.8);
            transition: width 0.3s ease;
        }

        .start-btn {
            background: linear-gradient(135deg, #48bb78, #38b2ac);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.2em;
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(72,187,120,0.3);
            display: block;
            margin: 0 auto;
        }

        .start-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(72,187,120,0.4);
        }

        .start-btn:disabled {
            background: #cbd5e0;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .quiz-container {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            display: none;
        }

        .quiz-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e2e8f0;
        }

        .quiz-progress {
            font-size: 1.1em;
            color: #5a67d8;
            font-weight: bold;
        }

        .korean-word {
            font-size: 2.5em;
            text-align: center;
            margin: 30px 0;
            color: #2d3748;
            font-weight: bold;
            padding: 20px;
            background: linear-gradient(135deg, #f7fafc, #edf2f7);
            border-radius: 15px;
            border-left: 5px solid #5a67d8;
        }

        .example-sentence {
            text-align: center;
            margin-bottom: 30px;
            font-style: italic;
            color: #718096;
            font-size: 1.1em;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 30px;
        }

        .option {
            padding: 20px;
            border: 2px solid #e2e8f0;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-size: 1.1em;
            background: white;
        }

        .option:hover {
            border-color: #5a67d8;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(90,103,216,0.2);
        }

        .option.correct {
            background: linear-gradient(135deg, #48bb78, #38b2ac);
            color: white;
            border-color: #48bb78;
        }

        .option.incorrect {
            background: linear-gradient(135deg, #f56565, #e53e3e);
            color: white;
            border-color: #f56565;
        }

        .option.disabled {
            pointer-events: none;
        }

        .next-btn {
            background: linear-gradient(135deg, #5a67d8, #667eea);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.1em;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: block;
            margin: 0 auto;
        }

        .next-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(90,103,216,0.3);
        }

        .back-btn {
            background: #718096;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            background: #4a5568;
            transform: translateY(-1px);
        }

        .result-container {
            background: white;
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            display: none;
        }

        .result-score {
            font-size: 3em;
            font-weight: bold;
            color: #5a67d8;
            margin-bottom: 20px;
        }

        .result-message {
            font-size: 1.3em;
            margin-bottom: 30px;
            color: #2d3748;
        }

        @media (max-width: 768px) {
            .options {
                grid-template-columns: 1fr;
            }
            
            .mode-buttons {
                justify-content: center;
            }
            
            .korean-word {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üá∞üá∑ KorVoca</h1>
            <p>ÌïúÍµ≠Ïñ¥ Îã®Ïñ¥ ÌïôÏäµ Ïï±</p>
        </div>

        <div id="mainMenu" class="main-menu">
            <div class="mode-selector">
                <h3>üìö ÌïôÏäµ Î™®Îìú ÏÑ†ÌÉù</h3>
                <div class="mode-buttons">
                    <button class="mode-btn active" data-mode="russian">üá∑üá∫ Îü¨ÏãúÏïÑÏñ¥</button>
                    <button class="mode-btn" data-mode="english">üá∫üá∏ ÏòÅÏñ¥</button>
                    <button class="mode-btn" data-mode="both">üåç Îëò Îã§</button>
                </div>
            </div>

            <div class="day-selector">
                <h3>üìÖ ÌïôÏäµÌï† Day ÏÑ†ÌÉù</h3>
                <div class="day-control">
                    <button class="arrow-btn" id="prevDay">‚Üê</button>
                    <div class="day-display">
                        <div class="day-title" id="currentDayTitle">DAY 1</div>
                        <div class="day-info">
                            <div class="day-progress" id="currentDayProgress">ÏßÑÎèÑ: 0%</div>
                            <div class="progress-bar">
                                <div class="progress-fill" id="currentProgressFill" style="width: 0%"></div>
                            </div>
                            <div class="day-rounds" id="currentDayRounds">ÌöåÎèÖ: 0Ìöå</div>
                        </div>
                    </div>
                    <button class="arrow-btn" id="nextDay">‚Üí</button>
                </div>
            </div>

            <button class="start-btn" id="startBtn">ÌïôÏäµ ÏãúÏûë</button>
        </div>

        <div id="quizContainer" class="quiz-container">
            <div class="quiz-header">
                <button class="back-btn" id="backBtn">‚Üê ÎèåÏïÑÍ∞ÄÍ∏∞</button>
                <div class="quiz-progress" id="quizProgress">1 / 20</div>
            </div>

            <div class="korean-word" id="koreanWord">loading...</div>
            <div class="example-sentence" id="exampleSentence">ÏòàÎ¨∏Ïù¥ Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§.</div>

            <div class="options" id="optionsContainer">
                <!-- Options will be generated here -->
            </div>

            <button class="next-btn" id="nextBtn" style="display: none;">Îã§Ïùå Î¨∏Ï†ú</button>
        </div>

        <div id="resultContainer" class="result-container">
            <div class="result-score" id="resultScore">85%</div>
            <div class="result-message" id="resultMessage">ÌõåÎ•≠Ìï©ÎãàÎã§!</div>
            <button class="start-btn" id="restartBtn">Îã§Ïãú ÏãúÏûë</button>
        </div>
    </div>

    <script>
        // ÏÉòÌîå Îç∞Ïù¥ÌÑ∞ (Ïã§Ï†úÎ°úÎäî JSON ÌååÏùºÏóêÏÑú Î°úÎìú)
        const sampleWords = [
            {korean: "Íµ≥Ïñ¥ÏßÄÎã§", russian: "—É–∫—Ä–µ–ø–∏—Ç—å—Å—è", english: "to harden", example: "ÏñëÍµ≠Ïùò ÎåÄÎ¶ΩÏù¥ Ï†êÏ†ê Íµ≥Ïñ¥ÏßÄÍ≥† ÏûàÎã§."},
            {korean: "Ï†ëÍ∑ºÌïòÎã§", russian: "–ø—Ä–∏–±–ª–∏–∂–∞—Ç—å—Å—è", english: "to approach", example: "Î¨∏Ï†úÏóê Ï≤¥Í≥ÑÏ†ÅÏúºÎ°ú Ï†ëÍ∑ºÌï¥Ïïº ÌïúÎã§."},
            {korean: "Î∞úÍ≤¨ÌïòÎã§", russian: "–æ–±–Ω–∞—Ä—É–∂–∏—Ç—å", english: "to discover", example: "ÏÉàÎ°úÏö¥ ÏÇ¨Ïã§ÏùÑ Î∞úÍ≤¨ÌñàÎã§."},
            {korean: "Ìï¥Í≤∞ÌïòÎã§", russian: "—Ä–µ—à–∞—Ç—å", english: "to solve", example: "Ïù¥ Î¨∏Ï†úÎ•º Ìï¥Í≤∞ÌïòÍ∏∞ ÏúÑÌï¥ ÎÖ∏Î†•ÌïòÍ≥† ÏûàÎã§."},
            {korean: "Í∞úÎ∞úÌïòÎã§", russian: "—Ä–∞–∑–≤–∏–≤–∞—Ç—å", english: "to develop", example: "ÏÉàÎ°úÏö¥ Í∏∞Ïà†ÏùÑ Í∞úÎ∞úÌïòÍ≥† ÏûàÎã§."},
            {korean: "Ïó∞Íµ¨ÌïòÎã§", russian: "–∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å", english: "to research", example: "Ïù¥ Î∂ÑÏïºÎ•º ÍπäÏù¥ Ïó∞Íµ¨ÌïòÍ≥† ÏûàÎã§."},
            {korean: "Î∂ÑÏÑùÌïòÎã§", russian: "–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å", english: "to analyze", example: "Îç∞Ïù¥ÌÑ∞Î•º ÏûêÏÑ∏Ìûà Î∂ÑÏÑùÌñàÎã§."},
            {korean: "Í¥ÄÏ∞∞ÌïòÎã§", russian: "–Ω–∞–±–ª—é–¥–∞—Ç—å", english: "to observe", example: "ÌòÑÏÉÅÏùÑ Ï£ºÏùòÍπäÍ≤å Í¥ÄÏ∞∞ÌñàÎã§."},
            {korean: "ÏÑ§Î™ÖÌïòÎã§", russian: "–æ–±—ä—è—Å–Ω—è—Ç—å", english: "to explain", example: "ÏõêÎ¶¨Î•º ÏâΩÍ≤å ÏÑ§Î™ÖÌï¥Ï£ºÏóàÎã§."},
            {korean: "Ï¶ùÎ™ÖÌïòÎã§", russian: "–¥–æ–∫–∞–∑—ã–≤–∞—Ç—å", english: "to prove", example: "Ïù¥Î°†ÏùÑ Ïã§ÌóòÏúºÎ°ú Ï¶ùÎ™ÖÌñàÎã§."}
        ];

        // Ï∂îÍ∞Ä Îã®Ïñ¥ ÌíÄ (ÏÑ†ÌÉùÏßÄÏö©)
        const additionalRussianWords = [
            "–ø–æ–Ω–∏–º–∞—Ç—å", "–∏–∑—É—á–∞—Ç—å", "—Ä–∞–±–æ—Ç–∞—Ç—å", "–¥—É–º–∞—Ç—å", "–≥–æ–≤–æ—Ä–∏—Ç—å", "–¥–µ–ª–∞—Ç—å", 
            "–∑–Ω–∞—Ç—å", "–≤–∏–¥–µ—Ç—å", "—Å–ª—ã—à–∞—Ç—å", "—á—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å", "–Ω–∞—Ö–æ–¥–∏—Ç—å", "–ø–æ–ª—É—á–∞—Ç—å",
            "—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è", "–æ—Å—Ç–∞–≤–∞—Ç—å—Å—è", "–∏–¥—Ç–∏", "–ø—Ä–∏—Ö–æ–¥–∏—Ç—å", "–∂–∏—Ç—å", "–∏–≥—Ä–∞—Ç—å"
        ];

        const additionalEnglishWords = [
            "to understand", "to study", "to work", "to think", "to speak", "to make",
            "to know", "to see", "to hear", "to feel", "to find", "to get",
            "to become", "to remain", "to go", "to come", "to live", "to play"
        ];

        // Ïï± ÏÉÅÌÉú
        let currentMode = 'russian';
        let selectedDay = 1; // Í∏∞Î≥∏Í∞íÏùÑ 1Î°ú ÏÑ§Ï†ï
        let currentWords = [];
        let currentQuestionIndex = 0;
        let correctAnswers = 0;
        let dayProgress = {};
        let sessionId = null; // ÏÑ∏ÏÖò ID Ï∂îÍ∞Ä

        // Day ÏÑ†ÌÉù Í¥ÄÎ†® Ìï®ÏàòÎì§
        function updateDayDisplay() {
            document.getElementById('currentDayTitle').textContent = `DAY ${selectedDay}`;
            
            const progress = dayProgress[selectedDay] || { progress: 0, rounds: 0 };
            document.getElementById('currentDayProgress').textContent = `ÏßÑÎèÑ: ${progress.progress}%`;
            document.getElementById('currentDayRounds').textContent = `ÌöåÎèÖ: ${progress.rounds}Ìöå`;
            document.getElementById('currentProgressFill').style.width = `${progress.progress}%`;
            
            // ÌôîÏÇ¥Ìëú Î≤ÑÌäº ÌôúÏÑ±Ìôî/ÎπÑÌôúÏÑ±Ìôî
            document.getElementById('prevDay').disabled = selectedDay <= 1;
            document.getElementById('nextDay').disabled = selectedDay >= 20;
        }

        // Ïù¥Ï†Ñ Day
        document.getElementById('prevDay').addEventListener('click', () => {
            if (selectedDay > 1) {
                selectedDay--;
                updateDayDisplay();
            }
        });

        // Îã§Ïùå Day
        document.getElementById('nextDay').addEventListener('click', () => {
            if (selectedDay < 20) {
                selectedDay++;
                updateDayDisplay();
            }
        });

        // Î°úÍ∑∏Ïù∏ ÌôïÏù∏
        function checkLogin() {
            const saved = localStorage.getItem('korvoca_session');
            if (saved) {
                sessionId = saved;
                showMainApp();
            } else {
                showLoginScreen();
            }
        }

        // Î°úÍ∑∏Ïù∏ ÌôîÎ©¥ ÌëúÏãú
        function showLoginScreen() {
            document.getElementById('mainMenu').style.display = 'none';
            document.getElementById('quizContainer').style.display = 'none';
            document.getElementById('resultContainer').style.display = 'none';
            
            // Î°úÍ∑∏Ïù∏ ÌôîÎ©¥Ïù¥ ÏóÜÏúºÎ©¥ ÏÉùÏÑ±
            if (!document.getElementById('loginContainer')) {
                const loginHtml = `
                    <div id="loginContainer" class="quiz-container" style="display: block; max-width: 400px; margin: 100px auto;">
                        <h2 style="text-align: center; margin-bottom: 30px; color: #5a67d8;">üîê KorVoca Î°úÍ∑∏Ïù∏</h2>
                        <form id="loginForm">
                            <div style="margin-bottom: 20px;">
                                <label style="display: block; margin-bottom: 8px; font-weight: bold;">ÏïÑÏù¥Îîî:</label>
                                <input type="text" id="username" required style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 16px;">
                            </div>
                            <div style="margin-bottom: 30px;">
                                <label style="display: block; margin-bottom: 8px; font-weight: bold;">ÎπÑÎ∞ÄÎ≤àÌò∏:</label>
                                <input type="password" id="password" required style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 16px;">
                            </div>
                            <button type="submit" class="start-btn" style="width: 100%;">Î°úÍ∑∏Ïù∏</button>
                        </form>
                        <div id="loginError" style="color: red; text-align: center; margin-top: 15px; display: none;"></div>
                    </div>
                `;
                document.querySelector('.container').insertAdjacentHTML('beforeend', loginHtml);
                
                // Î°úÍ∑∏Ïù∏ Ìèº Ïù¥Î≤§Ìä∏
                document.getElementById('loginForm').addEventListener('submit', handleLogin);
            } else {
                document.getElementById('loginContainer').style.display = 'block';
            }
        }

        // Î©îÏù∏ Ïï± ÌëúÏãú
        function showMainApp() {
            if (document.getElementById('loginContainer')) {
                document.getElementById('loginContainer').style.display = 'none';
            }
            document.getElementById('mainMenu').style.display = 'block';
            loadProgress();
            updateDayDisplay(); // Day ÏÑ†ÌÉùÍ∏∞ Ï¥àÍ∏∞Ìôî
        }

        // Î°úÍ∑∏Ïù∏ Ï≤òÎ¶¨
        async function handleLogin(e) {
            e.preventDefault();
            
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            const errorDiv = document.getElementById('loginError');
            
            try {
                const response = await fetch('/api/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ username, password })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    sessionId = result.sessionId;
                    localStorage.setItem('korvoca_session', sessionId);
                    showMainApp();
                    loadProgress();
                    generateDayCards();
                } else {
                    errorDiv.textContent = result.error;
                    errorDiv.style.display = 'block';
                }
                
            } catch (error) {
                errorDiv.textContent = 'Î°úÍ∑∏Ïù∏ Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.';
                errorDiv.style.display = 'block';
                console.error('Î°úÍ∑∏Ïù∏ Ïò§Î•ò:', error);
            }
        }

        // API ÏöîÏ≤≠Ïóê ÏÑ∏ÏÖò ID Ï∂îÍ∞Ä
        async function apiRequest(url, options = {}) {
            const headers = {
                'x-session-id': sessionId,
                ...options.headers
            };
            
            const response = await fetch(url, {
                ...options,
                headers
            });
            
            if (response.status === 401) {
                // ÏÑ∏ÏÖò ÎßåÎ£å
                localStorage.removeItem('korvoca_session');
                sessionId = null;
                showLoginScreen();
                throw new Error('ÏÑ∏ÏÖòÏù¥ ÎßåÎ£åÎêòÏóàÏäµÎãàÎã§. Îã§Ïãú Î°úÍ∑∏Ïù∏Ìï¥Ï£ºÏÑ∏Ïöî.');
            }
            
            return response;
        }

        // Î°úÏª¨ Ïä§ÌÜ†Î¶¨ÏßÄÏóêÏÑú ÏßÑÎèÑ Î∂àÎü¨Ïò§Í∏∞
        function loadProgress() {
            const saved = localStorage.getItem('korvoca_progress');
            if (saved) {
                dayProgress = JSON.parse(saved);
            } else {
                // Í∏∞Î≥∏ ÏßÑÎèÑ Îç∞Ïù¥ÌÑ∞
                for (let i = 1; i <= 20; i++) {
                    dayProgress[i] = { progress: 0, rounds: 0 };
                }
            }
        }

        // ÏßÑÎèÑ Ï†ÄÏû•
        function saveProgress() {
            localStorage.setItem('korvoca_progress', JSON.stringify(dayProgress));
        }

        // Day Ïπ¥Îìú ÏÉùÏÑ± (Îçî Ïù¥ÏÉÅ ÏÇ¨Ïö©ÌïòÏßÄ ÏïäÏùå)
        function generateDayCards() {
            // ÏÉàÎ°úÏö¥ UIÏóêÏÑúÎäî ÏÇ¨Ïö©ÌïòÏßÄ ÏïäÏùå
            updateDayDisplay();
        }

        // Day ÏÑ†ÌÉù (Îçî Ïù¥ÏÉÅ ÏÇ¨Ïö©ÌïòÏßÄ ÏïäÏùå)
        function selectDay(day) {
            // ÏÉàÎ°úÏö¥ UIÏóêÏÑúÎäî ÌôîÏÇ¥ÌëúÎ°ú ÏÑ†ÌÉù
            selectedDay = day;
            updateDayDisplay();
        }

        // Î™®Îìú ÏÑ†ÌÉù
        document.querySelectorAll('.mode-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentMode = btn.dataset.mode;
            });
        });

        // ÌÄ¥Ï¶à ÏãúÏûë
        document.getElementById('startBtn').addEventListener('click', startQuiz);

        async function startQuiz() {
            if (!selectedDay) return;

            try {
                // ÏÑúÎ≤Ñ APIÎ•º ÌÜµÌï¥ JSON Îç∞Ïù¥ÌÑ∞ Î°úÎìú (Ïù∏Ï¶ù Ìè¨Ìï®)
                const apiUrl = `/api/day/${selectedDay}`;
                console.log(`Î°úÎî© Ï§ë: Day ${selectedDay} Îç∞Ïù¥ÌÑ∞`);
                
                const response = await apiRequest(apiUrl);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const wordsData = await response.json();
                console.log(`Day ${selectedDay} Îç∞Ïù¥ÌÑ∞ Î°úÎìú ÏÑ±Í≥µ:`, wordsData.length, 'Í∞ú Îã®Ïñ¥');
                
                currentWords = Array.isArray(wordsData) ? [...wordsData] : [...sampleWords];
                currentQuestionIndex = 0;
                correctAnswers = 0;

                document.getElementById('mainMenu').style.display = 'none';
                document.getElementById('quizContainer').style.display = 'block';
                
                showQuestion();
                
            } catch (error) {
                console.error('Îç∞Ïù¥ÌÑ∞ Î°úÎìú Ïã§Ìå®:', error);
                alert(`Day ${selectedDay} Îç∞Ïù¥ÌÑ∞Î•º Î∂àÎü¨Ïò¨ Ïàò ÏóÜÏäµÎãàÎã§. ÏÉòÌîå Îç∞Ïù¥ÌÑ∞Î•º ÏÇ¨Ïö©Ìï©ÎãàÎã§.\nÏò§Î•ò: ${error.message}`);
                
                currentWords = [...sampleWords];
                currentQuestionIndex = 0;
                correctAnswers = 0;

                document.getElementById('mainMenu').style.display = 'none';
                document.getElementById('quizContainer').style.display = 'block';
                
                showQuestion();
            }
        }

        // Î¨∏Ï†ú ÌëúÏãú
        function showQuestion() {
            const word = currentWords[currentQuestionIndex];
            const totalQuestions = currentWords.length;
            
            document.getElementById('quizProgress').textContent = `${currentQuestionIndex + 1} / ${totalQuestions}`;
            document.getElementById('koreanWord').textContent = word.korean;
            document.getElementById('exampleSentence').textContent = word.example;
            document.getElementById('nextBtn').style.display = 'none';

            generateOptions(word);
        }

        // ÏÑ†ÌÉùÏßÄ ÏÉùÏÑ±
        function generateOptions(correctWord) {
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';

            let correctAnswer;
            let wrongAnswers = [];

            // Î™®ÎìúÏóê Îî∞Îùº Ï†ïÎãµÍ≥º Ïò§Îãµ ÏÉùÏÑ±
            if (currentMode === 'russian') {
                correctAnswer = correctWord.russian;
                wrongAnswers = getRandomWords(additionalRussianWords, 3);
            } else if (currentMode === 'english') {
                correctAnswer = correctWord.english;
                wrongAnswers = getRandomWords(additionalEnglishWords, 3);
            } else { // both
                if (Math.random() < 0.5) {
                    correctAnswer = correctWord.russian;
                    wrongAnswers = getRandomWords(additionalRussianWords, 3);
                } else {
                    correctAnswer = correctWord.english;
                    wrongAnswers = getRandomWords(additionalEnglishWords, 3);
                }
            }

            // ÏÑ†ÌÉùÏßÄ Î∞∞Ïó¥ ÏÉùÏÑ± Î∞è ÏÑûÍ∏∞
            const allOptions = [correctAnswer, ...wrongAnswers];
            shuffleArray(allOptions);

            // ÏÑ†ÌÉùÏßÄ Î≤ÑÌäº ÏÉùÏÑ±
            allOptions.forEach(option => {
                const button = document.createElement('button');
                button.className = 'option';
                button.textContent = option;
                button.addEventListener('click', () => selectOption(button, option, correctAnswer));
                optionsContainer.appendChild(button);
            });
        }

        // ÏÑ†ÌÉùÏßÄ ÏÑ†ÌÉù
        function selectOption(button, selected, correct) {
            const options = document.querySelectorAll('.option');
            options.forEach(opt => opt.classList.add('disabled'));

            if (selected === correct) {
                button.classList.add('correct');
                correctAnswers++;
            } else {
                button.classList.add('incorrect');
                // Ï†ïÎãµ ÌëúÏãú
                options.forEach(opt => {
                    if (opt.textContent === correct) {
                        opt.classList.add('correct');
                    }
                });
            }

            document.getElementById('nextBtn').style.display = 'block';
        }

        // Îã§Ïùå Î¨∏Ï†ú
        document.getElementById('nextBtn').addEventListener('click', () => {
            currentQuestionIndex++;
            
            if (currentQuestionIndex < currentWords.length) {
                showQuestion();
            } else {
                showResult();
            }
        });

        // Í≤∞Í≥º ÌëúÏãú
        function showResult() {
            const percentage = Math.round((correctAnswers / currentWords.length) * 100);
            
            // ÏßÑÎèÑ ÏóÖÎç∞Ïù¥Ìä∏
            dayProgress[selectedDay].progress = percentage;
            if (percentage === 100) {
                dayProgress[selectedDay].rounds++;
            }
            saveProgress();

            document.getElementById('quizContainer').style.display = 'none';
            document.getElementById('resultContainer').style.display = 'block';
            
            document.getElementById('resultScore').textContent = `${percentage}%`;
            
            let message = '';
            if (percentage >= 90) message = 'ÏôÑÎ≤ΩÌï©ÎãàÎã§! üéâ';
            else if (percentage >= 80) message = 'ÌõåÎ•≠Ìï©ÎãàÎã§! üëè';
            else if (percentage >= 70) message = 'Ï¢ãÏäµÎãàÎã§! üëç';
            else if (percentage >= 60) message = 'Í¥úÏ∞ÆÏäµÎãàÎã§! üòä';
            else message = 'Îçî Ïó∞ÏäµÌï¥Î≥¥ÏÑ∏Ïöî! üí™';
            
            document.getElementById('resultMessage').textContent = message;
        }

        // ÎèåÏïÑÍ∞ÄÍ∏∞ Î≤ÑÌäº
        document.getElementById('backBtn').addEventListener('click', () => {
            document.getElementById('quizContainer').style.display = 'none';
            document.getElementById('mainMenu').style.display = 'block';
            updateDayDisplay(); // ÏßÑÎèÑ ÏóÖÎç∞Ïù¥Ìä∏ Î∞òÏòÅ
        });

        // Îã§Ïãú ÏãúÏûë Î≤ÑÌäº
        document.getElementById('restartBtn').addEventListener('click', () => {
            document.getElementById('resultContainer').style.display = 'none';
            document.getElementById('mainMenu').style.display = 'block';
            updateDayDisplay(); // ÏßÑÎèÑ ÏóÖÎç∞Ïù¥Ìä∏ Î∞òÏòÅ
        });

        // Ïú†Ìã∏Î¶¨Ìã∞ Ìï®ÏàòÎì§
        function getRandomWords(wordArray, count) {
            const shuffled = [...wordArray].sort(() => 0.5 - Math.random());
            return shuffled.slice(0, count);
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        // Ïï± Ï¥àÍ∏∞Ìôî
        function initApp() {
            checkLogin(); // Î°úÍ∑∏Ïù∏ ÌôïÏù∏Î∂ÄÌÑ∞ ÏãúÏûë
        }

        // Ïï± ÏãúÏûë
        initApp();
    </script>
</body>
</html>